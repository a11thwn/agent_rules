# Bug Fix Skill

## 触发条件
当用户报告 Bug 或要求修复已知问题时使用此技能。

## 执行步骤

### 1. 问题诊断
- 读取错误信息和堆栈跟踪
- 理解用户的描述和复现步骤
- 定位问题代码（使用 grep、glob 搜索）

### 2. 根因分析

#### 快速排查
- [ ] 检查是否有明显的语法错误（lsp_diagnostics）
- [ ] 检查是否有逻辑错误（if/else 分支、循环条件）
- [ ] 检查是否有空值/未定义问题
- [ ] 检查是否有异步问题（Promise、await）

#### 深度分析
- [ ] 检查依赖的外部服务是否正常
- [ ] 检查数据流是否正确
- [ ] 检查边界条件处理
- [ ] 检查并发/竞态条件

### 3. 最小化修复原则
- **只修复 Bug，不重构**
- 修改范围尽可能小
- 不添加新功能
- 不优化现有代码

### 4. 修复验证

#### 自动化验证
- 运行相关测试：`bash ./scripts/test.sh`
- 运行构建：`bash ./scripts/build.sh`
- 检查诊断：`lsp_diagnostics`

#### 手动验证
- 描述复现步骤
- 说明预期行为
- 验证修复后行为符合预期

### 5. 输出格式

```
## Bug 修复报告

### 问题描述
[用户报告的问题和错误信息]

### 根因分析
[分析问题产生的原因]

### 修复方案
[说明修复思路和具体改动]

### 改动内容
**文件**: `path/to/file.ts`
**行数**: 第 X 行

**修改前**:
```typescript
// 原始代码
```

**修改后**:
```typescript
// 修复后的代码
```

### 验证结果
- [ ] 相关测试通过
- [ ] 构建成功
- [ ] 无新的诊断错误
- [ ] 手动验证通过

### 复现步骤
1. [步骤 1]
2. [步骤 2]
3. [步骤 3]

### 预期行为
[修复后的预期行为]

### 实际行为
[修复后的实际行为]
```

## 注意事项
- 修复前先创建备份或提交当前状态
- 如果修复导致其他问题，立即回滚
- 修复完成后更新 CHANGELOG.md
- 对于复杂 Bug，考虑咨询 Oracle
